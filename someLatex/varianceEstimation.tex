
% consistency of variance estimator 1
\begin{proof}[\textbf{Proof Of Proposition~\ref{varianceEstimation}}]
    Note that $(n-2)S\sim \mathrm{Wishart}_p (n-2,\Sigma)$.
    Denote by $\Sigma=OEO^T$ the spectral decomposition of $\Sigma$, where $O$ is an orthogonal matrix and $E=\mathrm{diag}(\lambda_1+\sigma^2,\ldots,\lambda_r+\sigma^2,\sigma^2,\ldots,\sigma^2)$.
    Let $Z$ be a $p\times (n-2)$ random matrix with all elements i.i.d.\ distributed as $N(0,1)$, then
    $$
        S\sim \frac{1}{n-2} O E^{1/2} Z Z^T E^{1/2} O^T.
    $$
    Thus,
    \begin{equation*}
        \begin{aligned}
            \hat{\sigma}^2&\sim
            \frac{1}{(p-r)(n-2)}\sum_{i=r+1}^p \lambda_i (O E^{1/2} Z Z^T E^{1/2} O^T)\\
            &=
            \frac{1}{(p-r)(n-2)}\sum_{i=r+1}^{n-2} \lambda_i ( Z^T E Z).
        \end{aligned}
    \end{equation*}
    Denote $Z^T={(Z_{(1)}^T,Z_{(2)}^T)}^T$, where $Z_{(1)}$ is the first $r$ rows of $Z$ and $Z_{(2)}$ is the rest rows. We have
    $$
    Z^T E Z =Z_{(1)}^T E_1 Z_{(1)}+\sigma^2 Z_{(2)}^T Z_{(2)},
    $$
    where $E_1=\mathrm{diag}(\lambda_1+\sigma^2,\ldots,\lambda_r +\sigma^2)$. The first term is of rank $r$. By Weyl's inequality, we have for $i=r+1,\ldots, n-2$ that
    $$
    \sigma^2\lambda_i(Z_{(2)}^T Z_{(2)}) \leq \lambda_i(Z^T E Z)\leq
    \sigma^2\lambda_{i-r}(Z_{(2)}^T Z_{(2)}).
    $$
    It follows that
    $$
    \sigma^2\sum_{i=r+1}^{n-2}\lambda_i(Z_{(2)}^T Z_{(2)}) \leq \sum_{i=r+1}^{n-2}\lambda_i(Z^T E Z)\leq
    \sigma^2\sum_{i=1}^{n-r-2}\lambda_{i}(Z_{(2)}^T Z_{(2)}).
    $$
    Hence we have
     \begin{equation*}
         \begin{aligned}
             &\Big|\frac{1}{(p-r)(n-2)}\sum_{i=r+1}^{n-2}\lambda_i(Z^T E Z)-
    \frac{1}{(p-r)(n-2)} \sigma^2\sum_{i=1}^{n-2}\lambda_{i}(Z_{(2)}^T Z_{(2)})\Big|
             \\
             \leq & r\sigma^2\frac{1}{(p-r)(n-2)} \lambda_1 (Z_{(2)}^T Z_{(2)}).
         \end{aligned}
     \end{equation*}
    By Corollary~\ref{maxEigen}, $\lambda_1 (Z_{(2)}^T Z_{(2)})=O_P(\max(n,p))$. Hence
     \begin{equation*}
         \begin{aligned}
             &\frac{1}{(p-r)(n-2)}\sum_{i=r+1}^{n-2}\lambda_i(Z^T E Z)\\
             =&
    \frac{1}{(p-r)(n-2)} \sigma^2\sum_{i=1}^{n-2}\lambda_{i}(Z_{(2)}^T Z_{(2)})
             +O_P(\frac{\max(n,p)}{np})\\
             =&
             \frac{1}{(p-r)(n-2)} \sigma^2\mathrm{tr}(Z_{(2)}^T Z_{(2)})
             +O_P(\frac{\max(n,p)}{np})\\
             =&
             \sigma^2+
                +O_P(\frac{1}{\sqrt{np}})
             +O_P(\frac{\max(n,p)}{np}).\\
         \end{aligned}
     \end{equation*}
     The last line of the above equality holds since $\mathrm{tr}(Z_{(2)}^T Z_{(2)})$ is the sum of square of the elements of $Z_{(2)}$ and thus central limit theorem can be invoked.
The theorem follows by noting that
$$
    O_{P}(\frac{1}{\sqrt{np}})=O_P(\frac{\sqrt{np}}{np})= O_P(\frac{\max (n,p)}{np}).
$$


\end{proof}
